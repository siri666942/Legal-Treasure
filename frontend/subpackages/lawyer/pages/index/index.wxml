<view class="lawyer-page">
  <!-- ç»Ÿè®¡æ•°æ®å¡ç‰‡ -->
  <view class="stats-section">
    <view class="stat-card todo">
      <view class="stat-content">
        <text class="stat-number">{{todoCount}}</text>
        <text class="stat-label">ä»Šæ—¥å¾…åŠ</text>
      </view>
      <view class="stat-icon">ğŸ“‹</view>
    </view>
    <view class="stat-card case">
      <view class="stat-content">
        <text class="stat-number">{{processingCaseCount}}</text>
        <text class="stat-label">å¤„ç†ä¸­æ¡ˆä»¶</text>
      </view>
      <view class="stat-icon">âš–ï¸</view>
    </view>
  </view>

  <!-- æˆ‘çš„æ¡ˆä»¶ - ä½¿ç”¨ displayCases ç¡®ä¿æ˜¾ç¤º -->
  <view class="case-section">
    <view class="section-header">
      <view class="title-wrapper">
        <text class="section-title">æˆ‘çš„æ¡ˆä»¶</text>
        <text class="case-count">{{cases.length}}ä»¶</text>
      </view>
      <text class="view-all" bindtap="viewAllCases">æŸ¥çœ‹å…¨éƒ¨ â€º</text>
    </view>

    <view class="case-list">
      <block wx:if="{{displayCases.length > 0}}">
        <block wx:for="{{displayCases}}" wx:key="id">
          <view class="case-item" bindtap="viewCaseDetail" data-id="{{item.id}}">
            <view class="case-header">
              <view class="case-title-wrap">
                <text class="case-name">{{item.name}}</text>
                <text class="case-status status-{{item.status}}">{{item.statusText}}</text>
              </view>
              <text class="case-no">{{item.caseNo}}</text>
            </view>
            <view class="case-client">ğŸ‘¤ {{item.client}}</view>
            <view class="progress-wrap">
              <text class="progress-value">{{item.progress}}%</text>
              <view class="progress-bar">
                <view class="progress-inner" style="width: {{item.progress+'%'}}"></view>
              </view>
            </view>
          </view>
        </block>
      </block>
      <view wx:else class="empty-tips">æš‚æ— æ¡ˆä»¶</view>
    </view>
  </view>

  <!-- ä»Šæ—¥æ—¥ç¨‹ - ä»…å«æ—¶é—´ã€æ ‡é¢˜ã€æè¿°ï¼Œå·²å®Œæˆä»»åŠ¡è‡ªåŠ¨ç½®åº• -->
  <view class="task-section">
    <view class="section-header">
      <view class="title-wrapper">
        <text class="section-title">ä»Šæ—¥æ—¥ç¨‹</text>
        <text class="task-count">{{tasks.length}}é¡¹</text>
      </view>
      <view class="action-buttons">
        <text class="capsule-btn" bindtap="viewCalendar">ğŸ“… æ—¥å†</text>
        <text class="capsule-btn primary" bindtap="showAddTaskModal">ï¼‹ æ–°å»º</text>
      </view>
    </view>

    <view class="task-list">
      <block wx:for="{{tasks}}" wx:key="id">
        <view class="task-item {{item.completed ? 'completed' : ''}}" bindtap="viewTaskDetail" data-id="{{item.id}}">
          <!-- å·¦ä¾§æ—¶é—´èƒ¶å›Š -->
          <view class="task-time">{{item.time}}</view>
          
          <!-- ä¸­é—´å†…å®¹åŒºåŸŸï¼šæ ‡é¢˜ + æè¿°ï¼ˆæè¿°ä¸ºç©ºæ—¶ä¸æ˜¾ç¤ºï¼‰ -->
          <view class="task-content">
            <view class="task-title">{{item.title}}</view>
            <view class="task-desc" wx:if="{{item.description}}">{{item.description}}</view>
          </view>
          
          <!-- å³ä¾§å®ŒæˆæŒ‰é’® -->
          <view 
            class="complete-btn {{item.completed ? 'checked' : ''}}" 
            bindtap="toggleTaskComplete" 
            data-id="{{item.id}}"
            catchtap
          >
            <text class="check-icon">{{item.completed ? 'âœ“' : ''}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- æ–°å»ºä»»åŠ¡æµ®çª— -->
  <view class="modal-overlay" wx:if="{{showTaskModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">æ–°å»ºä»»åŠ¡</text>
        <text class="close-btn" bindtap="hideTaskModal">Ã—</text>
      </view>
      <view class="form-content">
        <view class="form-item">
          <text class="form-label">ä»»åŠ¡æ ‡é¢˜</text>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥ä»»åŠ¡æ ‡é¢˜" 
            value="{{taskForm.title}}"
            bindinput="onTaskTitleInput"
            placeholder-class="placeholder"
          />
        </view>
        <view class="form-item">
          <text class="form-label">æ—¶é—´</text>
          <picker mode="time" value="{{taskForm.time}}" bindchange="onTimeChange">
            <view class="form-input time-picker">
              {{taskForm.time || 'è¯·é€‰æ‹©æ—¶é—´'}}
            </view>
          </picker>
        </view>
        <view class="form-item">
          <text class="form-label">æè¿°ï¼ˆå¯é€‰ï¼‰</text>
          <textarea 
            class="form-textarea" 
            placeholder="è¯·è¾“å…¥ä»»åŠ¡æè¿°" 
            value="{{taskForm.description}}"
            bindinput="onTaskDescriptionInput"
            maxlength="200"
            placeholder-class="placeholder"
          />
        </view>
      </view>
      <view class="modal-actions">
        <view class="btn cancel-btn" bindtap="hideTaskModal">å–æ¶ˆ</view>
        <view class="btn confirm-btn" bindtap="saveNewTask">ä¿å­˜</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨å¯¼èˆªï¼ˆå®Œå…¨ä¿ç•™ï¼‰ -->
  <view class="custom-tabbar">
    <block wx:for="{{tabList}}" wx:key="id">
      <view 
        class="tab-item {{item.active ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-id="{{item.id}}"
      >
        <view class="tab-icon {{item.icon}}"></view>
        <text class="tab-text">{{item.name}}</text>
      </view>
    </block>
  </view>
</view>