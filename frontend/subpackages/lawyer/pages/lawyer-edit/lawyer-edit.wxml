<view class="lawyer-edit-page">
  <scroll-view class="edit-content" scroll-y enhanced show-scrollbar="{{false}}">

    <!-- ===== å¤´åƒåŒºåŸŸï¼ˆæ”¯æŒå›¾ç‰‡æˆ–è¡¨æƒ…ç¬¦å·ï¼‰===== -->
    <view class="avatar-section">
      <view class="avatar-container">
        <view class="avatar-wrapper" bindtap="uploadAvatar">
          <view class="avatar-emoji" wx:if="{{!lawyerInfo.avatar}}">
            {{lawyerInfo.avatarEmoji}}
          </view>
          <image class="avatar-image" wx:else src="{{lawyerInfo.avatar}}" mode="aspectFill"></image>
          <text class="avatar-hint">ç‚¹å‡»æ›´æ¢</text>
        </view>
      </view>
    </view>

    <!-- ===== åŸºæœ¬ä¿¡æ¯å¡ç‰‡ ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">åŸºæœ¬ä¿¡æ¯</text>
      </view>
      <view class="card-content">
        <view class="form-item">
          <text class="form-label">å§“å <text class="required">*</text></text>
          <input class="form-input" placeholder="è¯·è¾“å…¥å§“å" value="{{lawyerInfo.name}}" 
                 bindinput="onInputChange" data-field="name" />
        </view>
        <view class="form-item">
          <text class="form-label">å¤´è¡”</text>
          <input class="form-input" placeholder="å¦‚ï¼šé«˜çº§åˆä¼™äººå¾‹å¸ˆ" value="{{lawyerInfo.title}}" 
                 bindinput="onInputChange" data-field="title" />
        </view>
        <view class="form-item">
          <text class="form-label">æ‰§ä¸šæœºæ„</text>
          <input class="form-input" placeholder="è¯·è¾“å…¥æ‰§ä¸šæœºæ„" value="{{lawyerInfo.organization}}" 
                 bindinput="onInputChange" data-field="organization" />
        </view>
        <view class="form-item">
          <text class="form-label">æ‰§ä¸šè¯å· <text class="required">*</text></text>
          <input class="form-input" placeholder="è¯·è¾“å…¥æ‰§ä¸šè¯å·" value="{{lawyerInfo.licenseNumber}}" 
                 bindinput="onInputChange" data-field="licenseNumber" />
        </view>
        <view class="form-row">
          <view class="form-item half">
            <text class="form-label">æ‰§ä¸šå¹´é™</text>
            <input class="form-input" placeholder="å¦‚ï¼š15" value="{{lawyerInfo.practiceYears}}" 
                   bindinput="onInputChange" data-field="practiceYears" type="number" />
          </view>
          <view class="form-item half">
            <text class="form-label">æ‰§ä¸šåŒºåŸŸ</text>
            <input class="form-input" placeholder="å¦‚ï¼šå…¨å›½" value="{{lawyerInfo.practiceArea}}" 
                   bindinput="onInputChange" data-field="practiceArea" />
          </view>
        </view>
        <view class="form-item">
          <text class="form-label">ä¸“ä¸šæ–¹å‘</text>
          <input class="form-input" placeholder="å¦‚ï¼šæ°‘å•†äº‹è¯‰è®¼ã€å…¬å¸æ³•åŠ¡" value="{{lawyerInfo.expertise}}" 
                 bindinput="onInputChange" data-field="expertise" />
        </view>
      </view>
    </view>

    <!-- ===== ä¸“ä¸šæ•°æ®ç»Ÿè®¡ ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">ä¸“ä¸šæ•°æ®</text>
      </view>
      <view class="card-content">
        <view class="stats-grid">
          <view class="stat-item">
            <text class="stat-label">ç´¯è®¡åŠæ¡ˆ</text>
            <input class="stat-input" placeholder="0" value="{{lawyerInfo.stats.caseCount}}" 
                   bindinput="onInputChange" data-subfield="stats.caseCount" type="number" />
          </view>
          <view class="stat-item">
            <text class="stat-label">èƒœè¯‰ç‡(%)</text>
            <input class="stat-input" placeholder="0" value="{{lawyerInfo.stats.winRate}}" 
                   bindinput="onInputChange" data-subfield="stats.winRate" type="number" />
          </view>
          <view class="stat-item">
            <text class="stat-label">å®¢æˆ·æ»¡æ„åº¦(%)</text>
            <input class="stat-input" placeholder="0" value="{{lawyerInfo.stats.clientSatisfaction}}" 
                   bindinput="onInputChange" data-subfield="stats.clientSatisfaction" type="number" />
          </view>
          <view class="stat-item">
            <text class="stat-label">æ‰§ä¸šç»éªŒ(å¹´)</text>
            <input class="stat-input" placeholder="0" value="{{lawyerInfo.stats.years}}" 
                   bindinput="onInputChange" data-subfield="stats.years" type="number" />
          </view>
        </view>
      </view>
    </view>

    <!-- ===== æ•™è‚²èƒŒæ™¯ ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">æ•™è‚²èƒŒæ™¯</text>
      </view>
      <view class="card-content">
        <view class="form-item">
          <text class="form-label">æœ€é«˜å­¦ä½</text>
          <input class="form-input" placeholder="å¦‚ï¼šæ³•å­¦ç¡•å£«" value="{{lawyerInfo.education.degree}}" 
                 bindinput="onInputChange" data-subfield="education.degree" />
        </view>
        <view class="form-item">
          <text class="form-label">æ¯•ä¸šé™¢æ ¡</text>
          <input class="form-input" placeholder="å¦‚ï¼šä¸­å›½æ”¿æ³•å¤§å­¦" value="{{lawyerInfo.education.school}}" 
                 bindinput="onInputChange" data-subfield="education.school" />
        </view>
        <view class="form-item">
          <text class="form-label">ä¸“ä¸š</text>
          <input class="form-input" placeholder="å¦‚ï¼šæ°‘å•†æ³•å­¦" value="{{lawyerInfo.education.major}}" 
                 bindinput="onInputChange" data-subfield="education.major" />
        </view>
      </view>
    </view>

    <!-- ===== è¯­è¨€èƒ½åŠ› ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">è¯­è¨€èƒ½åŠ›</text>
      </view>
      <view class="card-content">
        <textarea class="form-textarea" placeholder="å¦‚ï¼šä¸­æ–‡æ™®é€šè¯ï¼ˆæ¯è¯­ï¼‰ã€è‹±è¯­ï¼ˆä¸“ä¸šå…«çº§ï¼‰" 
                  value="{{lawyerInfo.languageSkills}}" bindinput="onInputChange" data-field="languageSkills" 
                  maxlength="200" />
        <view class="textarea-counter">{{lawyerInfo.languageSkills.length || 0}}/200</view>
      </view>
    </view>

    <!-- ===== ä¸“ä¸šä»‹ç» ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">ä¸“ä¸šä»‹ç»</text>
      </view>
      <view class="card-content">
        <textarea class="form-textarea" placeholder="è¯·è¯¦ç»†ä»‹ç»æ‚¨çš„ä¸“ä¸šèƒŒæ™¯ã€æ‰§ä¸šç»éªŒç­‰" 
                  value="{{lawyerInfo.introduction}}" bindinput="onInputChange" data-field="introduction" 
                  maxlength="500" />
        <view class="textarea-counter">{{lawyerInfo.introduction.length || 0}}/500</view>
      </view>
    </view>

    <!-- ===== ä¸“ä¸šé¢†åŸŸ ===== -->
    <view class="edit-card">
      <view class="card-header">
        <text class="card-title">ä¸“ä¸šé¢†åŸŸ</text>
      </view>
      <view class="card-content">
        <view class="form-item">
          <text class="form-label">ä¸“ä¸šé¢†åŸŸï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</text>
          <input class="form-input" placeholder="å¦‚ï¼šåˆåŒçº çº·,å…¬å¸è‚¡æƒ,é‡‘èè¯åˆ¸" 
                 value="{{lawyerInfo.expertiseAreasInput}}" bindinput="onInputChange" 
                 data-field="expertiseAreasInput" />
        </view>
        <view class="tags-preview">
          <text class="tags-label">é¢„è§ˆæ•ˆæœï¼š</text>
          <view class="tags-container">
            <view class="tag-item" wx:for="{{expertiseTags}}" wx:key="index">{{item}}</view>
            <view class="tag-empty" wx:if="{{expertiseTags.length === 0}}">æš‚æ— æ ‡ç­¾</view>
          </view>
        </view>
      </view>
    </view>

    <!-- ===== å·¥ä½œç»å†ï¼ˆå¯æ·»åŠ /åˆ é™¤ï¼‰===== -->
    <view class="edit-card">
      <view class="card-header with-action">
        <text class="card-title">å·¥ä½œç»å†</text>
        <view class="section-action" bindtap="addWorkExperience">
          <text class="action-icon">+</text>
          <text class="action-text">æ·»åŠ </text>
        </view>
      </view>
      <view class="card-content experience-list">
        <view class="experience-item" wx:for="{{lawyerInfo.workExperience}}" wx:key="index" wx:for-index="idx">
          <view class="experience-header">
            <text class="experience-index">ç»å† {{idx + 1}}</text>
            <view class="experience-actions" wx:if="{{lawyerInfo.workExperience.length > 1}}">
              <text class="action-delete" bindtap="removeWorkExperience" data-index="{{idx}}">åˆ é™¤</text>
            </view>
          </view>
          <view class="form-item">
            <text class="form-label">æ—¶é—´æ®µ</text>
            <input class="form-input" placeholder="å¦‚ï¼š2008å¹´-è‡³ä»Š" value="{{item.period}}" 
                   bindinput="onWorkExperienceInput" data-index="{{idx}}" data-field="period" />
          </view>
          <view class="form-item">
            <text class="form-label">èŒä½</text>
            <input class="form-input" placeholder="å¦‚ï¼šé«˜çº§åˆä¼™äºº" value="{{item.position}}" 
                   bindinput="onWorkExperienceInput" data-index="{{idx}}" data-field="position" />
          </view>
          <view class="form-item">
            <text class="form-label">è¯¦ç»†æè¿°</text>
            <textarea class="form-textarea compact" placeholder="è¯·æè¿°å·¥ä½œèŒè´£å’Œæˆå°±" 
                      value="{{item.detail}}" bindinput="onWorkExperienceInput" 
                      data-index="{{idx}}" data-field="detail" maxlength="200" />
            <view class="textarea-counter">{{item.detail.length || 0}}/200</view>
          </view>
        </view>
      </view>
    </view>

    <!-- ===== ä»£è¡¨æ€§æ¡ˆä¾‹ï¼ˆå¯æ·»åŠ /åˆ é™¤ï¼‰===== -->
    <view class="edit-card">
      <view class="card-header with-action">
        <text class="card-title">ä»£è¡¨æ€§æ¡ˆä¾‹</text>
        <view class="section-action" bindtap="addCaseExperience">
          <text class="action-icon">+</text>
          <text class="action-text">æ·»åŠ </text>
        </view>
      </view>
      <view class="card-content case-list">
        <view class="case-item" wx:for="{{lawyerInfo.caseExperience}}" wx:key="index" wx:for-index="idx">
          <view class="case-header">
            <text class="case-index">æ¡ˆä¾‹ {{idx + 1}}</text>
            <view class="case-actions" wx:if="{{lawyerInfo.caseExperience.length > 1}}">
              <text class="action-delete" bindtap="removeCaseExperience" data-index="{{idx}}">åˆ é™¤</text>
            </view>
          </view>
          <view class="form-item">
            <text class="form-label">æ¡ˆä¾‹æ ‡é¢˜</text>
            <input class="form-input" placeholder="å¦‚ï¼šæŸä¸Šå¸‚å…¬å¸è‚¡æƒçº çº·æ¡ˆ" value="{{item.title}}" 
                   bindinput="onCaseExperienceInput" data-index="{{idx}}" data-field="title" />
          </view>
          <view class="form-item">
            <text class="form-label">æ¡ˆä¾‹ç±»å‹</text>
            <input class="form-input" placeholder="å¦‚ï¼šå•†äº‹è¯‰è®¼" value="{{item.type}}" 
                   bindinput="onCaseExperienceInput" data-index="{{idx}}" data-field="type" />
          </view>
          <view class="form-item">
            <text class="form-label">æ¡ˆä¾‹è¯¦æƒ…</text>
            <textarea class="form-textarea compact" placeholder="è¯·æè¿°æ¡ˆä»¶æƒ…å†µå’Œæ‚¨çš„è§’è‰²" 
                      value="{{item.detail}}" bindinput="onCaseExperienceInput" 
                      data-index="{{idx}}" data-field="detail" maxlength="300" />
            <view class="textarea-counter">{{item.detail.length || 0}}/300</view>
          </view>
          <view class="form-item">
            <text class="form-label">æ¡ˆä»¶ç»“æœ</text>
            <input class="form-input" placeholder="å¦‚ï¼šèƒœè¯‰ï¼Œä¸ºå®¢æˆ·æŒ½å›æŸå¤±3.2äº¿å…ƒ" value="{{item.result}}" 
                   bindinput="onCaseExperienceInput" data-index="{{idx}}" data-field="result" />
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å¡«å……åŒºåŸŸï¼Œé¿å…å†…å®¹è¢«å›ºå®šæ“ä½œæ é®æŒ¡ -->
    <view class="bottom-padding"></view>
  </scroll-view>

  <!-- ===== åº•éƒ¨æ“ä½œæ  ===== -->
  <view class="edit-footer">
    <view class="footer-buttons">
      <view class="footer-btn cancel-btn" bindtap="cancelEdit">
        <text class="btn-text">å–æ¶ˆ</text>
      </view>
      <view class="footer-btn preview-btn" bindtap="previewCard">
        <text class="btn-text">é¢„è§ˆ</text>
      </view>
      <view class="footer-btn save-btn" bindtap="saveLawyerInfo">
        <text class="btn-text">ä¿å­˜</text>
      </view>
    </view>
  </view>

  <!-- ===== åç‰‡é¢„è§ˆæµ®çª—ï¼ˆå¤´åƒåŒºåŸŸå·²æ”¯æŒå›¾ç‰‡ï¼‰===== -->
  <view class="preview-modal-overlay" wx:if="{{showPreviewModal}}">
    <view class="preview-modal-container">
      <view class="preview-modal-header">
        <text class="preview-modal-title">åç‰‡é¢„è§ˆ</text>
        <view class="preview-modal-close" bindtap="closePreviewModal">âœ•</view>
      </view>
      <scroll-view class="preview-modal-content" scroll-y>
        <!-- ä»¥ä¸‹å†…å®¹å®Œå…¨æ¨¡ä»¿å®¢æˆ·ç«¯å¾‹å¸ˆåç‰‡é¡µé¢çš„è§†è§‰ç»“æ„ -->
        <view class="preview-lawyer-detail-page">

          <!-- å¾‹å¸ˆæƒå¨å¤´è¡”åŒºåŸŸï¼ˆä¼˜å…ˆæ˜¾ç¤ºå›¾ç‰‡ï¼‰ -->
          <view class="preview-lawyer-authority-section">
            <view class="preview-lawyer-header-card">
              <view class="preview-lawyer-avatar-wrapper">
                <image class="preview-lawyer-avatar-image" wx:if="{{previewData.avatar}}" src="{{previewData.avatar}}" mode="aspectFill"></image>
                <view class="preview-lawyer-avatar-emoji" wx:else>{{previewData.avatarEmoji}}</view>
                <view class="preview-lawyer-badge">æƒå¨è®¤è¯</view>
              </view>
              <view class="preview-lawyer-intro-section">
                <text class="preview-lawyer-name">{{previewData.name}}</text>
                <text class="preview-lawyer-title">{{previewData.title}}</text>
                <view class="preview-lawyer-organization">
                  <text class="preview-organization-name">{{previewData.organization}}</text>
                  <text class="preview-organization-rank">å…¨å›½ç™¾å¼ºå¾‹æ‰€</text>
                </view>
              </view>
            </view>
            <view class="preview-honor-tags">
              <view class="preview-honor-tag">é«˜çº§åˆä¼™äºº</view>
              <view class="preview-honor-tag">èµ„æ·±å¾‹å¸ˆ</view>
              <view class="preview-honor-tag">æ³•å¾‹é¡¾é—®</view>
              <view class="preview-honor-tag">ä¸“å®¶å§”å‘˜</view>
            </view>
          </view>

          <!-- æ•´åˆä¿¡æ¯æ¨¡å— -->
          <view class="preview-integrated-info-section">
            <!-- æ‰§ä¸šä¿¡æ¯ç½‘æ ¼ -->
            <view class="preview-info-grid">
              <view class="preview-info-item">
                <view class="preview-info-icon">âš–ï¸</view>
                <view class="preview-info-content">
                  <text class="preview-info-label">æ‰§ä¸šè¯å·</text>
                  <text class="preview-info-value">{{previewData.licenseNumber}}</text>
                </view>
              </view>
              <view class="preview-info-item">
                <view class="preview-info-icon">â³</view>
                <view class="preview-info-content">
                  <text class="preview-info-label">æ‰§ä¸šå¹´é™</text>
                  <text class="preview-info-value">{{previewData.practiceYears}}å¹´</text>
                </view>
              </view>
              <view class="preview-info-item">
                <view class="preview-info-icon">ğŸ“</view>
                <view class="preview-info-content">
                  <text class="preview-info-label">æ‰§ä¸šåŒºåŸŸ</text>
                  <text class="preview-info-value">{{previewData.practiceArea}}</text>
                </view>
              </view>
              <view class="preview-info-item">
                <view class="preview-info-icon">ğŸ¯</view>
                <view class="preview-info-content">
                  <text class="preview-info-label">ä¸“ä¸šæ–¹å‘</text>
                  <text class="preview-info-value">{{previewData.expertise}}</text>
                </view>
              </view>
            </view>

            <!-- ä¸“ä¸šèµ„è´¨ -->
            <view class="preview-qualification-section">
              <view class="preview-section-header">
                <text class="preview-section-title">ä¸“ä¸šèµ„è´¨</text>
              </view>
              <view class="preview-qualification-list">
                <view class="preview-qualification-item">
                  <view class="preview-qualification-label">
                    <text class="preview-qualification-icon">ğŸ“</text>
                    <text class="preview-qualification-text">æ•™è‚²èƒŒæ™¯</text>
                  </view>
                  <view class="preview-qualification-value">
                    <text class="preview-qualification-main">{{previewData.education.degree}}</text>
                    <text class="preview-qualification-sub">{{previewData.education.school}} Â· {{previewData.education.major}}</text>
                  </view>
                </view>
                <view class="preview-qualification-item">
                  <view class="preview-qualification-label">
                    <text class="preview-qualification-icon">ğŸ“œ</text>
                    <text class="preview-qualification-text">ä¸“ä¸šè®¤è¯</text>
                  </view>
                  <view class="preview-qualification-value">
                    <text class="preview-qualification-main">å›½å®¶å¸æ³•éƒ¨æ³¨å†Œæ‰§ä¸šå¾‹å¸ˆ</text>
                    <text class="preview-qualification-sub">å¾‹å¸ˆåä¼šä¼šå‘˜ Â· æ— è¿è§„è®°å½•</text>
                  </view>
                </view>
                <view class="preview-qualification-item">
                  <view class="preview-qualification-label">
                    <text class="preview-qualification-icon">ğŸ—£ï¸</text>
                    <text class="preview-qualification-text">è¯­è¨€èƒ½åŠ›</text>
                  </view>
                  <view class="preview-qualification-value">
                    <text class="preview-qualification-main">{{previewData.languageSkills}}</text>
                  </view>
                </view>
              </view>
            </view>

            <!-- ä¸“ä¸šä»‹ç» -->
            <view class="preview-introduction-section">
              <view class="preview-section-header">
                <text class="preview-section-title">ä¸“ä¸šä»‹ç»</text>
              </view>
              <view class="preview-introduction-content">
                <text class="preview-introduction-text">{{previewData.introduction}}</text>
              </view>
            </view>

            <!-- ä¸“ä¸šé¢†åŸŸ -->
            <view class="preview-expertise-section">
              <view class="preview-section-header">
                <text class="preview-section-title">ä¸“ä¸šé¢†åŸŸ</text>
              </view>
              <view class="preview-expertise-tags">
                <block wx:for="{{previewData.expertiseAreas || expertiseTags}}" wx:key="index">
                  <view class="preview-expertise-tag">{{item}}</view>
                </block>
              </view>
            </view>
          </view>

          <!-- ä¸“ä¸šæ•°æ®ç»Ÿè®¡ -->
          <view class="preview-stats-section">
            <view class="preview-section-title">
              <text class="preview-title-text">ä¸“ä¸šæ•°æ®</text>
            </view>
            <view class="preview-stats-grid">
              <view class="preview-stat-card">
                <text class="preview-stat-number">{{previewData.stats.caseCount}}+</text>
                <text class="preview-stat-label">ç´¯è®¡åŠæ¡ˆ</text>
                <text class="preview-stat-desc">æˆåŠŸæ¡ˆä¾‹</text>
              </view>
              <view class="preview-stat-card">
                <text class="preview-stat-number">{{previewData.stats.winRate}}%</text>
                <text class="preview-stat-label">èƒœè¯‰ç‡</text>
                <text class="preview-stat-desc">æ¡ˆä»¶æˆåŠŸç‡</text>
              </view>
              <view class="preview-stat-card">
                <text class="preview-stat-number">{{previewData.stats.clientSatisfaction}}%</text>
                <text class="preview-stat-label">å®¢æˆ·æ»¡æ„</text>
                <text class="preview-stat-desc">æœåŠ¡æ»¡æ„åº¦</text>
              </view>
              <view class="preview-stat-card">
                <text class="preview-stat-number">{{previewData.stats.years}}+</text>
                <text class="preview-stat-label">æ‰§ä¸šç»éªŒ</text>
                <text class="preview-stat-desc">èµ„æ·±ä¸“ä¸š</text>
              </view>
            </view>
          </view>

          <!-- æ‰§ä¸šç»å† -->
          <view class="preview-experience-section">
            <view class="preview-section-title">
              <text class="preview-title-text">æ‰§ä¸šç»å†</text>
            </view>
            <view class="preview-experience-timeline">
              <view class="preview-timeline-item" wx:for="{{previewData.workExperience}}" wx:key="index">
                <view class="preview-timeline-dot"></view>
                <view class="preview-timeline-content">
                  <text class="preview-timeline-period">{{item.period}}</text>
                  <text class="preview-timeline-position">{{item.position}}</text>
                  <text class="preview-timeline-detail">{{item.detail}}</text>
                </view>
              </view>
            </view>
          </view>

          <!-- ä»£è¡¨æ€§æ¡ˆä¾‹ -->
          <view class="preview-case-section">
            <view class="preview-section-title">
              <text class="preview-title-text">ä»£è¡¨æ€§æ¡ˆä¾‹</text>
            </view>
            <view class="preview-case-list">
              <view class="preview-case-card" wx:for="{{previewData.caseExperience}}" wx:key="index">
                <view class="preview-case-header">
                  <text class="preview-case-title">{{item.title}}</text>
                  <text class="preview-case-type">{{item.type}}</text>
                </view>
                <text class="preview-case-detail">{{item.detail}}</text>
                <view class="preview-case-result">
                  <text class="preview-result-label">æ¡ˆä»¶ç»“æœï¼š</text>
                  <text class="preview-result-text">{{item.result}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>
</view>