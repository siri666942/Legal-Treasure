<!-- pages/index/index.wxml -->
<view class="index-page">
  <!-- AIæ³•å¾‹é¡¾é—®å¡ç‰‡ -->
  <view class="ai-section">
    <view class="ai-card">
      <!-- AIåŠ©æ‰‹å¤´éƒ¨ -->
      <view class="ai-header" bindtap="navigateToAIChat">
        <view class="ai-avatar-container">
          <view class="ai-avatar">
            <text>ğŸ¤–</text>
          </view>
          <view class="ai-avatar-badge">AI</view>
        </view>
        <view class="ai-info">
          <text class="ai-title">AIæ³•å¾‹åŠ©æ‰‹</text>
          <text class="ai-desc">æ™ºèƒ½è§£ç­”æ³•å¾‹é—®é¢˜</text>
        </view>
        <view class="ai-arrow">â€º</view>
      </view>
      
      <!-- å››ä¸ªåŠŸèƒ½æŒ‰é’® -->
      <view class="ai-features">
        <view class="feature-item" bindtap="navigateToFindLawyer">
          <view class="feature-icon">
            <text>ğŸ‘¨â€âš–ï¸</text>
          </view>
          <text class="feature-text">å¯»æ‰¾å¾‹å¸ˆ</text>
        </view>
        <view class="feature-item" bindtap="navigateToCaseSearch">
          <view class="feature-icon">
            <text>ğŸ”</text>
          </view>
          <text class="feature-text">æ¡ˆä¾‹æ£€ç´¢</text>
        </view>
        <view class="feature-item" bindtap="navigateToFeeCalculate">
          <view class="feature-icon">
            <text>ğŸ’°</text>
          </view>
          <text class="feature-text">è¯‰è®¼è´¹ç”¨</text>
        </view>
        <view class="feature-item" bindtap="navigateToOnlineConsult">
          <view class="feature-icon">
            <text>ğŸ’¬</text>
          </view>
          <text class="feature-text">åœ¨çº¿å’¨è¯¢</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„æ¡ˆä»¶è¿›åº¦ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„æ¡ˆä»¶è¿›åº¦</text>
      <text class="section-more" bindtap="navigateToAllCases">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    
    <view class="case-card" wx:if="{{activeCase}}" bindtap="navigateToCaseDetail">
      <view class="case-header">
        <view class="case-title-row">
          <text class="case-name">{{activeCase.name}}</text>
          <text class="case-status">{{activeCase.status}}</text>
        </view>
        <view class="case-date">{{activeCase.date}}</view>
      </view>
      
      <view class="progress-container">
        <view class="progress-info">
          <text class="progress-label">æ¡ˆä»¶è¿›åº¦</text>
          <text class="progress-value">{{activeCase.progress}}%</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{activeCase.progress+'%'}}"></view>
        </view>
      </view>
      
      <view class="case-footer">
        <text class="case-type">{{activeCase.type}}</text>
        <view class="case-arrow">â€º</view>
      </view>
    </view>
    
    <view class="empty-case" wx:else bindtap="navigateToCreateCase">
      <view class="empty-icon">ğŸ“</view>
      <text class="empty-text">æš‚æ— è¿›è¡Œä¸­çš„æ¡ˆä»¶</text>
      <text class="empty-action">åˆ›å»ºæ–°æ¡ˆä»¶</text>
    </view>
  </view>

  <!-- ä»»åŠ¡ä»£åŠï¼ˆå¸¦å®Œæˆå¤é€‰æ¡†ï¼‰ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä»»åŠ¡ä»£åŠ</text>
      <text class="section-more" bindtap="navigateToAllTasks">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    
    <view class="todo-list">
      <block wx:for="{{todoList}}" wx:key="id">
        <view class="todo-item {{item.completed ? 'completed' : ''}}">
          <!-- å·¦ä¾§å®Œæˆå¤é€‰æ¡† -->
          <view class="todo-checkbox" bindtap="toggleTaskComplete" data-id="{{item.id}}" catchtap>
            <view class="checkbox {{item.completed ? 'checked' : ''}}">
              <text wx:if="{{item.completed}}">âœ“</text>
            </view>
          </view>
          <!-- ä»»åŠ¡å†…å®¹ï¼ˆç‚¹å‡»è¿›å…¥è¯¦æƒ…ï¼‰ -->
          <view class="todo-middle" bindtap="navigateToTaskDetail" data-id="{{item.id}}">
            <text class="todo-title">{{item.task}}</text>
            <view class="todo-detail">
              <text class="todo-detail-item">{{item.case}}</text>
              <text class="todo-detail-item">{{item.initiator}}</text>
            </view>
          </view>
          <!-- å³ä¾§æ—¶é—´ + ç´§æ€¥æ ‡è¯† -->
          <view class="todo-right">
            <text class="todo-time">{{item.time}}</text>
            <view class="todo-urgent" wx:if="{{item.urgent}}">æ€¥</view>
          </view>
        </view>
      </block>
    </view>
    
    <view class="empty-todo" wx:if="{{todoList.length === 0}}">
      <view class="empty-icon">âœ…</view>
      <text class="empty-text">æš‚æ— å¾…åŠä»»åŠ¡</text>
    </view>
  </view>

  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="custom-tabbar">
    <view 
      class="tab-item {{currentTab === 0 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-id="0"
    >
      <view class="tab-icon icon-home"></view>
      <text class="tab-text">ä¸»é¡µ</text>
    </view>
    <view 
      class="tab-item {{currentTab === 1 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-id="1"
    >
      <view class="tab-icon icon-case"></view>
      <text class="tab-text">æ¡ˆä»¶</text>
    </view>
    <view 
      class="tab-item {{currentTab === 2 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-id="2"
    >
      <view class="tab-icon icon-chat"></view>
      <text class="tab-text">æ²Ÿé€š</text>
    </view>
    <view 
      class="tab-item {{currentTab === 3 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-id="3"
    >
      <view class="tab-icon icon-mine"></view>
      <text class="tab-text">æˆ‘çš„</text>
    </view>
  </view>
</view>