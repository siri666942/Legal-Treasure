<view class="container">
  <!-- æ¡ˆä»¶æ ‡é¢˜å’Œæ“ä½œ -->
  <view class="case-header">
    <view class="case-title-row">
      <text class="case-title">{{caseInfo.caseTitle}}</text>
    </view>
    <view class="case-no-row">
      <text class="case-no">{{caseInfo.caseNo}}</text>
      <text class="copy-icon" bindtap="copyCaseNo">ğŸ“‹</text>
    </view>
  </view>

  <!-- æ¡ˆä»¶åŸºæœ¬ä¿¡æ¯ -->
  <view class="card">
    <view class="card-header">
      <view class="card-title-with-icon">
        <view class="card-icon">
          <text class="icon">ğŸ“‹</text>
        </view>
        <text class="card-title">æ¡ˆä»¶åŸºæœ¬ä¿¡æ¯</text>
      </view>
    </view>
    <view class="card-content">
      <view class="info-grid">
        <view class="info-item">
          <text class="label">æ¡ˆå·ï¼š</text>
          <text class="value">{{caseInfo.caseNo}}</text>
        </view>
        <view class="info-item">
          <text class="label">æ¡ˆä»¶æ€§è´¨ï¼š</text>
          <text class="value">{{caseInfo.caseType}}</text>
        </view>
        <view class="info-item">
          <text class="label">å—ç†æ³•é™¢ï¼š</text>
          <text class="value">{{caseInfo.court}}</text>
        </view>
        <view class="info-item">
          <text class="label">æ‰¿åŠæ³•å®˜ï¼š</text>
          <text class="value">{{caseInfo.judge}}</text>
        </view>
        <view class="info-item">
          <text class="label">ç«‹æ¡ˆæ—¶é—´ï¼š</text>
          <text class="value">{{caseInfo.filingDate}}</text>
        </view>
        <view class="info-item">
          <text class="label">å½“å‰çŠ¶æ€ï¼š</text>
          <view class="status-badge status-active">å®¡ç†ä¸­</view>
        </view>
        <view class="info-item">
          <text class="label">æ ‡çš„é‡‘é¢ï¼š</text>
          <text class="value">{{caseInfo.amount}}</text>
        </view>
        <view class="info-item">
          <text class="label">é€‚ç”¨æ³•å¾‹ï¼š</text>
          <text class="value">{{caseInfo.applicableLaw}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ¡ˆä»¶æ—¶é—´è½´ï¼ˆåªè¯»ï¼‰ -->
  <view class="card collapsible-card">
    <view class="card-header" bindtap="toggleTimeline">
      <view class="card-title-with-icon">
        <view class="card-icon">
          <text class="icon">ğŸ“…</text>
        </view>
        <text class="card-title">æ¡ˆä»¶æ—¶é—´è½´</text>
      </view>
      <view class="collapse-icon">
        <text class="icon">{{timelineExpanded ? 'â–²' : 'â–¼'}}</text>
        <text class="collapse-text">{{timelineExpanded ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
      </view>
    </view>

    <!-- å±•å¼€çŠ¶æ€ -->
    <view wx:if="{{timelineExpanded}}" class="card-content">
      <view class="timeline">
        <view class="timeline-item" wx:for="{{timeline}}" wx:key="index">
          <view class="timeline-dot {{item.status}}"></view>
          <view class="timeline-content">
            <view class="timeline-date">{{item.date}}</view>
            <view class="timeline-event">{{item.event}}</view>
            <view class="timeline-desc" wx:if="{{item.description}}">{{item.description}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æŠ˜å çŠ¶æ€ - åŠ¨æ€ç®€ç•¥æ˜¾ç¤ºï¼ˆå‰4æ¡ï¼‰ -->
    <view class="collapsed-content" wx:else>
      <view class="collapsed-items">
        <view class="collapsed-item" wx:for="{{timeline.slice(0,4)}}" wx:key="index">
          <view class="collapsed-dot {{item.status}}"></view>
          <text class="collapsed-text">{{item.date}} {{item.event}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å…³è”å·å®—ï¼ˆåªè¯»ï¼Œä¿ç•™å³ä¾§â€œâ‹¯â€èœå•ï¼‰ -->
  <view class="card collapsible-card">
    <view class="card-header" bindtap="toggleDocuments">
      <view class="card-title-with-icon">
        <view class="card-icon">
          <text class="icon">ğŸ“</text>
        </view>
        <text class="card-title">å…³è”å·å®—</text>
      </view>
      <view class="collapse-icon">
        <text class="icon">{{documentsExpanded ? 'â–²' : 'â–¼'}}</text>
        <text class="collapse-text">{{documentsExpanded ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
      </view>
    </view>

    <!-- å±•å¼€çŠ¶æ€ -->
    <view wx:if="{{documentsExpanded}}" class="card-content">
      <view class="documents-grid">
        <view class="document-item" wx:for="{{documents}}" wx:key="index">
          <view class="document-info">
            <text class="document-name">{{item.name}}</text>
            <text class="document-meta">{{item.type}} â€¢ {{item.size}} â€¢ {{item.date}}</text>
            <text class="document-uploader">ä¸Šä¼ ï¼š{{item.uploadedBy}}</text>
          </view>
          <view class="document-more" bindtap="showFileActions" data-index="{{index}}">
            <text>â‹¯</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æŠ˜å çŠ¶æ€ - åŠ¨æ€ç®€ç•¥æ˜¾ç¤ºï¼ˆå‰3æ¡ï¼‰ -->
    <view class="collapsed-content" wx:else>
      <view class="collapsed-items">
        <view class="collapsed-item" wx:for="{{documents.slice(0,3)}}" wx:key="index">
          <text class="collapsed-text">{{item.name}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ¡ˆä»¶ç›¸å…³æ–¹ï¼ˆåªè¯»ï¼Œæ— è”ç³»æŒ‰é’®ï¼‰ -->
  <view class="card collapsible-card">
    <view class="card-header" bindtap="toggleParties">
      <view class="card-title-with-icon">
        <view class="card-icon">
          <text class="icon">ğŸ‘¥</text>
        </view>
        <text class="card-title">æ¡ˆä»¶ç›¸å…³æ–¹</text>
      </view>
      <view class="collapse-icon">
        <text class="icon">{{partiesExpanded ? 'â–²' : 'â–¼'}}</text>
        <text class="collapse-text">{{partiesExpanded ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
      </view>
    </view>

    <!-- å±•å¼€çŠ¶æ€ -->
    <view wx:if="{{partiesExpanded}}" class="card-content">
      <view class="parties-container">
        <view class="party-card" wx:for="{{parties}}" wx:key="id">
          <view class="party-header">
            <view class="party-avatar {{item.roleClass}}">
              <text>{{item.id}}</text>
            </view>
            <view class="party-title">
              <text class="party-name">{{item.name}}</text>
              <text class="party-type">{{item.type}}</text>
            </view>
          </view>
          <view class="party-details">
            <text class="party-role">{{item.role}}</text>
            <text class="party-contact" wx:if="{{item.contact}}">{{item.contact}}</text>
            <text class="party-address" wx:if="{{item.address}}">{{item.address}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æŠ˜å çŠ¶æ€ - åŠ¨æ€ç®€ç•¥æ˜¾ç¤ºï¼ˆå‰4æ¡ï¼‰ -->
    <view class="collapsed-content" wx:else>
      <view class="collapsed-items">
        <view class="collapsed-item" wx:for="{{parties.slice(0,4)}}" wx:key="index">
          <view class="collapsed-avatar {{item.roleClass}}">
            <text>{{item.id}}</text>
          </view>
          <text class="collapsed-text">{{item.name}} - {{item.role}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è”ç³»å¾‹å¸ˆæŒ‰é’® -->
  <view class="contact-lawyer-wrapper">
    <view class="contact-lawyer-btn" bindtap="contactLawyer">
      <text class="btn-icon">ğŸ“</text>
      <text class="btn-text">è”ç³»å¾‹å¸ˆ</text>
    </view>
  </view>

</view>