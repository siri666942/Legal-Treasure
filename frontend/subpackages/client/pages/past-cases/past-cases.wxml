<view class="history-page">
  <!-- æœç´¢æ  -->
  <view class="search-container">
    <view class="search-input">
      <text class="search-icon">ğŸ”</text>
      <input 
        class="search-input-inner" 
        placeholder="æœç´¢æ¡ˆä»¶å·ã€å½“äº‹äººå§“å" 
        bindconfirm="onSearch"
        bindinput="onSearchInput"
        value="{{searchKeyword}}"
      />
      <text wx:if="{{searchKeyword}}" class="clear-icon" bindtap="clearSearch">âœ•</text>
    </view>
    <view class="search-btn" bindtap="onSearch">æœç´¢</view>
  </view>
  
  <!-- ç­›é€‰æ¡ä»¶ï¼ˆå®Œå…¨ä¿ç•™åŸæ ·å¼ï¼‰ -->
  <view class="filter-container">
    <view class="filter-item">
      <text class="filter-label">æ¡ˆä»¶ç±»å‹ï¼š</text>
      <picker 
        class="filter-picker" 
        range="{{caseTypes}}" 
        value="{{caseTypeIndex}}" 
        bindchange="onCaseTypeChange"
      >
        <view class="picker-content {{caseTypeIndex === -1 ? 'placeholder' : ''}}">
          {{caseTypeIndex === -1 ? 'å…¨éƒ¨ç±»å‹' : caseTypes[caseTypeIndex]}}
        </view>
      </picker>
    </view>
    
    <view class="filter-item">
      <text class="filter-label">ç»“æ¡ˆæ—¶é—´ï¼š</text>
      <picker 
        class="filter-picker" 
        mode="date" 
        fields="year" 
        value="{{yearFilter}}" 
        bindchange="onYearChange"
      >
        <view class="picker-content {{!yearFilter ? 'placeholder' : ''}}">
          {{yearFilter ? yearFilter + 'å¹´' : 'å…¨éƒ¨å¹´ä»½'}}
        </view>
      </picker>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡ä¿¡æ¯ï¼ˆå®Œå…¨ä¿ç•™åŸæ ·å¼ï¼‰ -->
  <view class="stats-container">
    <text class="stats-text">å…±æ‰¾åˆ° {{filteredCaseList.length}} ä¸ªè¿‡å¾€æ¡ˆä»¶</text>
    <text class="clear-filters" bindtap="clearFilters" wx:if="{{searchKeyword || caseTypeIndex !== -1 || yearFilter}}">
      æ¸…é™¤ç­›é€‰
    </text>
  </view>
  
  <!-- æ¡ˆä»¶åˆ—è¡¨ï¼ˆä»…ç§»é™¤çŠ¶æ€æ ‡ç­¾å’Œå¤šä½™æŒ‰é’®ï¼Œå¡ç‰‡å¸ƒå±€å®Œå…¨ä¸å˜ï¼‰ -->
  <scroll-view class="case-list" scroll-y="true">
    <block wx:for="{{filteredCaseList}}" wx:key="id">
      <view class="case-item" bindtap="viewCaseDetail" data-id="{{item.id}}">
        <view class="case-header">
          <view class="case-no-container">
            <text class="case-no">{{item.caseNo}}</text>
            <text class="case-type-tag">{{item.type || 'æ°‘äº‹'}}</text>
          </view>
          <!-- ã€å·²ç§»é™¤ã€‘å·²ç»“æ¡ˆçŠ¶æ€æ ‡ç­¾ -->
          <!-- åŸä»£ç æ­¤å¤„æœ‰ <text class="case-status status-completed">å·²ç»“æ¡ˆ</text>ï¼Œå·²åˆ é™¤ -->
        </view>
        
        <view class="case-title-row">
          <text class="case-title">{{item.title}}</text>
          <text class="case-date">{{item.completeDate || item.date}}</text>
        </view>
        
        <view class="case-info">
          <view class="info-item">
            <text class="info-label">å½“äº‹äººï¼š</text>
            <text class="info-value">{{item.client}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">ç»“æ¡ˆæ–¹å¼ï¼š</text>
            <text class="info-value">{{item.completeType || 'åˆ¤å†³'}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">å®¡ç†æ³•é™¢ï¼š</text>
            <text class="info-value">{{item.court || 'XXäººæ°‘æ³•é™¢'}}</text>
          </view>
        </view>
        
        <!-- æ“ä½œåŒºï¼šä»…ä¿ç•™â€œæŸ¥çœ‹è¯¦æƒ…â€æŒ‰é’®ï¼Œç§»é™¤å…¶ä»–ä¸¤ä¸ªæŒ‰é’® -->
        <view class="case-actions">
          <text class="case-action" bindtap="viewCaseDetail" data-id="{{item.id}}">æŸ¥çœ‹è¯¦æƒ…</text>
          <!-- å·²ç§»é™¤ï¼šæŸ¥çœ‹å·å®—ã€è”ç³»å½“äº‹äºº -->
        </view>
      </view>
    </block>
    
    <!-- ç©ºçŠ¶æ€æç¤ºï¼ˆå®Œå…¨ä¿ç•™åŸæ ·å¼ï¼‰ -->
    <view wx:if="{{filteredCaseList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“š</view>
      <text class="empty-title">æš‚æ— è¿‡å¾€æ¡ˆä»¶</text>
      <text class="empty-desc" wx:if="{{searchKeyword || caseTypeIndex !== -1 || yearFilter}}">
        æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ¡ˆä»¶
      </text>
      <text class="empty-desc" wx:else>
        æ‚¨è¿˜æ²¡æœ‰å·²ç»“æ¡ˆçš„æ¡ˆä»¶è®°å½•
      </text>
      <view class="empty-actions">
        <view class="empty-action" bindtap="clearFilters" wx:if="{{searchKeyword || caseTypeIndex !== -1 || yearFilter}}">
          æ¸…é™¤ç­›é€‰æ¡ä»¶
        </view>
        <view class="empty-action" bindtap="goBack" wx:else>
          è¿”å›æ¡ˆä»¶åˆ—è¡¨
        </view>
      </view>
    </view>
  </scroll-view>
</view>